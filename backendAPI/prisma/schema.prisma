// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserType {
  Admin
  Borrower
}

model User {
  user_id       String          @id @default(uuid()) // Primary Key
  email         String          @unique
  username      String          @unique
  password_hash String
  type          UserType // Enum: 'Admin', 'Borrower'
  // Define the relation to the Book table
  borrowedBooks BorrowedBooks[] // One-to-many relation
  Book          Book[]
}

// Define the Book table
model Book {
  book_id       String          @id @default(uuid()) // Primary Key
  title         String
  quantity      Int
  return_date   DateTime?
  // Define the relation to the User table
  added_by      String
  user_added_by User            @relation(fields: [added_by], references: [user_id]) // Foreign Key
  BorrowedBooks BorrowedBooks[]
}

// Define the BorrowedBooks table
model BorrowedBooks {
  borrow_id   String    @id @default(uuid()) // Primary Key
  book_id     String // Foreign Key
  user_id     String // Foreign Key
  borrow_date DateTime
  return_date DateTime?
  // Define the relations to the Book and User tables
  book        Book      @relation(fields: [book_id], references: [book_id])
  user        User      @relation(fields: [user_id], references: [user_id])
}

